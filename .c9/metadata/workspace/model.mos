{"changed":false,"filter":false,"title":"model.mos","tooltip":"/model.mos","value":"model electric_charging_point\r\n\r\nuses \"mmxprs\"\r\nuses \"mmsheet\"\r\n\r\ndeclarations\r\nnumber_of_year = 4\r\nyear = 0..number_of_year\r\nyear14 = 1..number_of_year\r\n\r\nnumber_of_charing_type = 3\r\ncharing_type = 1..number_of_charing_type\r\ncharing_type_name: array(charing_type) of string\r\n\r\nno_centre_point = 185\r\ncentre_point = 1..no_centre_point\r\nno_sub_point = 162\r\nsub_point = 1..no_sub_point\r\n\r\nno_potential_point = 304\r\npotential_point = 1..no_potential_point\r\ncurrent_point = 305..347                    !potential 304, current 43\r\n\r\nno_total_point = 347\r\ntotal_point = 1..no_total_point\r\n\r\nno_total_demand = 103\r\ntotal_demand = 1..no_total_demand\r\n\r\n\r\n\r\nM,set_up_cost,station_cost_slow,station_cost_fast,station_cost_rapid,use_rate_slow,use_rate_fast,\r\nuse_rate_rapid,capacity_slow,capacity_fast,capacity_rapid: real\r\ndistance_p_i: array(total_point) of real\r\ndistance_bet_points: array(total_point,total_point) of real\r\ndem_point_bi: array(total_point,total_demand) of real\r\ndemand: array(total_demand,year14) of real\r\ncurrent_stations: array(current_point,charing_type) of real\r\n\r\npoint_bi, point_slow, point_fast, point_rapid, point_total,\r\npoint_bi_eachyear, point_slow_eachyear, point_fast_eachyear,\r\npoint_rapid_eachyear: array(total_point,year) of mpvar\r\npoint_point_bi: array(total_point,total_point,year) of mpvar\r\nenergy_deliver: array(total_point,total_demand,year14) of mpvar\r\n\r\ncost, interest_distance: mpvar\r\n\r\nend-declarations\r\n\r\ninitialisations from \"final_data\"\r\n  M set_up_cost station_cost_slow station_cost_fast station_cost_rapid use_rate_slow use_rate_fast\r\n  use_rate_rapid capacity_slow capacity_fast capacity_rapid charing_type_name\r\nend-initialisations\r\n\r\ninitializations from \"mmsheet.csv: Distance_D_and_P_bi.csv\"\r\ndem_point_bi as \"noindex;[B2:MJ348]\"\r\nend-initializations\r\n\r\ninitializations from \"mmsheet.csv: Distance_between_points.csv\"\r\ndistance_bet_points as \"noindex;[B2:MJ348]\"\r\nend-initializations\r\n\r\ninitializations from \"mmsheet.csv: new_data.csv\"\r\ndemand as \"noindex;[L2:O104]\"\r\nend-initializations\r\n\r\ninitializations from \"mmsheet.csv: Current_point.csv\"\r\ncurrent_stations as \"noindex;[E2:G44]\"\r\nend-initializations\r\n\r\ninitializations from \"mmsheet.csv: Distance_I_and_P_min.csv\"\r\ndistance_p_i as \"noindex;[B2:B348]\"\r\nend-initializations\r\n\r\n\r\n\r\n\r\n! Objective: to minimise cost\r\nobj := cost  !interest_distance\r\n\r\n! Define 2 objectives to be minimised\r\ncost = (sum(p in total_point) point_bi(p,4) - 43) * set_up_cost +\r\n       (sum(p in total_point) point_slow(p,4) - 47) * station_cost_slow +\r\n       (sum(p in total_point) point_fast(p,4) - 18) * station_cost_fast +\r\n       (sum(p in total_point) point_rapid(p,4) - 13) * station_cost_rapid\r\n\r\ninterest_distance = sum(p in total_point) point_bi(p,4)*distance_p_i(p)\r\n\r\n! Interest distance constraint\r\n!interest_distance <= 5300\r\n\r\n! Binary constraints\r\nforall (p in total_point, y in year) do\r\n  point_bi(p,y) is_binary\r\n  point_total(p,y) <= point_bi(p,y)*M\r\nend-do\r\n\r\n! Integer constraints\r\nforall (p in total_point, y in year) do\r\n  point_slow(p,y) is_integer\r\n  point_fast(p,y) is_integer\r\n  point_rapid(p,y) is_integer\r\n  point_bi_eachyear(p,y) is_integer\r\n  point_slow_eachyear(p,y) is_integer\r\n  point_fast_eachyear(p,y) is_integer\r\n  point_rapid_eachyear(p,y) is_integer\r\nend-do\r\n\r\n! Increase constraints\r\nforall (p in total_point, y in year14) do\r\n  point_bi_eachyear(p,y) = point_bi(p,y) - point_bi(p,y-1)\r\n  point_slow_eachyear(p,y) = point_slow(p,y) - point_slow(p,y-1)\r\n  point_fast_eachyear(p,y) = point_fast(p,y) - point_fast(p,y-1)\r\n  point_rapid_eachyear(p,y) = point_rapid(p,y) - point_rapid(p,y-1)\r\nend-do\r\n\r\n! Point binary matrix\r\nforall (p1 in total_point, p2 in total_point, y in year | p1 < p2) do\r\n  point_point_bi(p1,p2,y) is_binary\r\n  point_bi(p1,y) + point_bi(p2,y) - 1 <= point_point_bi(p1,p2,y)*M\r\nend-do\r\n\r\n! Define point_total\r\nforall (p in total_point, y in year) do\r\n  point_total(p,y) = point_slow(p,y) + point_fast(p,y) + point_rapid(p,y)\r\nend-do\r\n\r\n! Density constraint\r\nforall (p1 in total_point, p2 in total_point, y in year | p1 < p2) do\r\n  distance_bet_points(p1,p2) -20 -5*(point_total(p1,y)+point_total(p2,y)) >= -M*(1-point_point_bi(p1,p2,y))\r\nend-do\r\n\r\n! Energy deliver constraint, if not in distance, then can not deliver energy\r\nforall (p in total_point, d in total_demand, y in year14) do\r\n  energy_deliver(p,d,y) <= dem_point_bi(p,d)*M\r\nend-do\r\n\r\n! Capacity = sum of energy delivered\r\nforall (p in total_point, y in year14) do\r\n  point_slow(p,y)*capacity_slow*use_rate_slow + point_fast(p,y)*capacity_fast*use_rate_fast +\r\n  point_rapid(p,y)*capacity_rapid*use_rate_rapid >= sum(d in total_demand) energy_deliver(p,d,y)\r\nend-do\r\n\r\n! Meet demand\r\nforall (d in total_demand, y in year14) do\r\n  sum(p in total_point) energy_deliver(p,d,y) >= demand(d,y)*0.8\r\nend-do\r\n\r\n! Max number of stations limit for each point\r\nforall (p in total_point, y in year) do\r\n  point_total(p,y) <= 10\r\nend-do\r\n\r\n! Make sure the number of rapid stations for each point for each year\r\nforall(p in total_point, y in year14) do\r\n  point_rapid_eachyear(p,y) <= (point_slow_eachyear(p,y) + point_fast_eachyear(p,y))*0.5\r\nend-do\r\n\r\n\r\n! Define current points & stations\r\nforall (c in current_point) do\r\n  point_bi(c,0) = 1\r\n  point_bi_eachyear(c,0) = 1\r\n  point_slow(c,0) = current_stations(c,1)\r\n  point_slow_eachyear(c,0) = current_stations(c,1)\r\n  point_fast(c,0) = current_stations(c,2)\r\n  point_fast_eachyear(c,0) = current_stations(c,2)\r\n  point_rapid(c,0) = current_stations(c,3)\r\n  point_rapid_eachyear(c,0) = current_stations(c,3)\r\nend-do\r\n\r\nforall (p in potential_point) do\r\n  point_bi(p,0) = 0\r\n  point_bi_eachyear(p,0) = 0\r\n  point_slow(p,0) = 0\r\n  point_slow_eachyear(p,0) = 0\r\n  point_fast(p,0) = 0\r\n  point_fast_eachyear(p,0) = 0\r\n  point_rapid(p,0) = 0\r\n  point_rapid_eachyear(p,0) = 0\r\nend-do\r\n\r\n\r\n\r\nminimise(obj)\r\n\r\nwriteln\r\nwriteln(\"cost: \",getsol(cost))\r\nwriteln\r\nwriteln(\"interest distance: \",getsol(interest_distance))\r\n\r\n\r\nend-model\r\n","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":306,"scrollleft":0,"selection":{"start":{"row":0,"column":0},"end":{"row":0,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":18,"state":"start","mode":"plugins/fico.ide.language.mosel/mode/mosel"}},"timestamp":1669589079000}